<html>
	<head>
		<meta charset="utf-8"/>
		<title>Furniture Helper</title>
		<link rel="stylesheet" href="../styles/common.css"/>
		<link rel="stylesheet" href="../styles/page_wrapper.css"/>
		<link rel="stylesheet" href="../styles/fall_down_menu.css"/>
		<link rel="stylesheet" href="../styles/loader.css"/>
		<link rel="stylesheet" href="../styles/color_list.css"/>
		<script src="../scripts/libs/vue.js"></script>
		<script src="../scripts/libs/jquery.js"></script>
		<script src="../scripts/connector.js"></script>
		<script src="../scripts/continious_handler.js"></script>
		<script src="../scripts/response_handler.js"></script>
	</head>
	<body>
		<div id="header-wrapper"></div>
		
		<div class="content">
			<div id="loader" class="centered-loader default-loader"></div>
			<div id="color-list-wrapper" class="default-list">
				<div v-for="color in colors" class="default-list-item">
					<div v-bind:style="color.hex | hexToBackColor" class="default-sampler"></div>
					<div class="color-list-item-content">
						#{{ color.id }} "{{ color.name }}" <span v-if="color.description != ''">â€” {{ color.description }}</span>
					</div>
				</div>
			</div>
		</div>
		
		<div class="footer"></div>
		
		<script>
			Vue.filter('hexToBackColor', function (hex) {
				return "background-color : #" + hex + ";";
			});
		
			$(function(){ $("#header-wrapper").load("header.html"); });
		
			async function init() {
				let loader = document.getElementById("loader");
				colorListHandler(await handleContinious(getColorsList, loader));
			}
			
			async function getColorsList() {
				return await SendGetAsync("colors/get");
			}
			
			function colorListHandler(result) {
				handleResponse(
					result,
					error => alert(error.error_message),
					data => buildColorList(data)
				);
			}
			
			function buildColorList(colorList) {
				new Vue({
					el : "#color-list-wrapper",
					data : { colors : colorList } 
				});
			}
			
			init();
		</script>
	</body>
</html>